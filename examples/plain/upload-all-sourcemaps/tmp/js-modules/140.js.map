{"version":3,"sources":["/Users/jamielynch/repos/bugsnag-react-native/examples/plain/node_modules/react-native/Libraries/Blob/FileReader.js"],"sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n * @format\n */\n\n'use strict';\n\nconst EventTarget = require('event-target-shim');\nconst Blob = require('Blob');\nconst {FileReaderModule} = require('NativeModules');\n\ntype ReadyState =\n  | 0 // EMPTY\n  | 1 // LOADING\n  | 2; // DONE\n\ntype ReaderResult = string | ArrayBuffer;\n\nconst READER_EVENTS = [\n  'abort',\n  'error',\n  'load',\n  'loadstart',\n  'loadend',\n  'progress',\n];\n\nconst EMPTY = 0;\nconst LOADING = 1;\nconst DONE = 2;\n\nclass FileReader extends EventTarget(...READER_EVENTS) {\n  static EMPTY = EMPTY;\n  static LOADING = LOADING;\n  static DONE = DONE;\n\n  EMPTY = EMPTY;\n  LOADING = LOADING;\n  DONE = DONE;\n\n  _readyState: ReadyState;\n  _error: ?Error;\n  _result: ?ReaderResult;\n  _aborted: boolean = false;\n  _subscriptions: Array<*> = [];\n\n  constructor() {\n    super();\n    this._reset();\n  }\n\n  _reset(): void {\n    this._readyState = EMPTY;\n    this._error = null;\n    this._result = null;\n  }\n\n  _clearSubscriptions(): void {\n    this._subscriptions.forEach(sub => sub.remove());\n    this._subscriptions = [];\n  }\n\n  _setReadyState(newState: ReadyState) {\n    this._readyState = newState;\n    this.dispatchEvent({type: 'readystatechange'});\n    if (newState === DONE) {\n      if (this._aborted) {\n        this.dispatchEvent({type: 'abort'});\n      } else if (this._error) {\n        this.dispatchEvent({type: 'error'});\n      } else {\n        this.dispatchEvent({type: 'load'});\n      }\n      this.dispatchEvent({type: 'loadend'});\n    }\n  }\n\n  readAsArrayBuffer() {\n    throw new Error('FileReader.readAsArrayBuffer is not implemented');\n  }\n\n  readAsDataURL(blob: Blob) {\n    this._aborted = false;\n\n    FileReaderModule.readAsDataURL(blob.data).then(\n      (text: string) => {\n        if (this._aborted) {\n          return;\n        }\n        this._result = text;\n        this._setReadyState(DONE);\n      },\n      error => {\n        if (this._aborted) {\n          return;\n        }\n        this._error = error;\n        this._setReadyState(DONE);\n      },\n    );\n  }\n\n  readAsText(blob: Blob, encoding: string = 'UTF-8') {\n    this._aborted = false;\n\n    FileReaderModule.readAsText(blob.data, encoding).then(\n      (text: string) => {\n        if (this._aborted) {\n          return;\n        }\n        this._result = text;\n        this._setReadyState(DONE);\n      },\n      error => {\n        if (this._aborted) {\n          return;\n        }\n        this._error = error;\n        this._setReadyState(DONE);\n      },\n    );\n  }\n\n  abort() {\n    this._aborted = true;\n    // only call onreadystatechange if there is something to abort, as per spec\n    if (this._readyState !== EMPTY && this._readyState !== DONE) {\n      this._reset();\n      this._setReadyState(DONE);\n    }\n    // Reset again after, in case modified in handler\n    this._reset();\n  }\n\n  get readyState(): ReadyState {\n    return this._readyState;\n  }\n\n  get error(): ?Error {\n    return this._error;\n  }\n\n  get result(): ?ReaderResult {\n    return this._result;\n  }\n}\n\nmodule.exports = FileReader;\n"],"names":["EventTarget","require","d","FileReaderModule","EMPTY","LOADING","DONE","FileReader","_this","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","call","_aborted","_subscriptions","_reset","_readyState","_error","_result","forEach","sub","remove","newState","dispatchEvent","type","Error","blob","_this2","readAsDataURL","data","then","text","_setReadyState","error","_this3","encoding","arguments","length","undefined","readAsText","apply","module","exports"],"mappings":"4BAUA,mEAEMA,EAAcC,EAAOC,EAAA,IAEpBC,GADMF,EAAOC,EAAA,IACOD,EAAOC,EAAA,IAA3BC,kBAkBDC,EAAQ,EACRC,EAAU,EACVC,EAAO,EAEPC,eAeJ,SAAAA,IAAc,IAAAC,EAAA,OAAAC,EAAAC,KAAAH,IACZC,EAAAG,EAAAD,KAAAE,EAAAL,GAAAM,KAAAH,QAXFN,MAAQA,EAUMI,EATdH,QAAUA,EASIG,EARdF,KAAOA,EAQOE,EAHdM,UAAoB,EAGNN,EAFdO,kBAIEP,EAAKQ,SAFOR,oDAMZE,KAAKO,YAAcb,EACnBM,KAAKQ,OAAS,KACdR,KAAKS,QAAU,mDAIfT,KAAKK,eAAeK,QAAQ,SAAAC,GAAG,OAAIA,EAAIC,WACvCZ,KAAKK,yDAGQQ,GACbb,KAAKO,YAAcM,EACnBb,KAAKc,eAAeC,KAAM,qBACtBF,IAAajB,IACXI,KAAKI,SACPJ,KAAKc,eAAeC,KAAM,UACjBf,KAAKQ,OACdR,KAAKc,eAAeC,KAAM,UAE1Bf,KAAKc,eAAeC,KAAM,SAE5Bf,KAAKc,eAAeC,KAAM,yDAK5B,MAAM,IAAIC,MAAM,yFAGJC,GAAY,IAAAC,EAAAlB,KACxBA,KAAKI,UAAW,EAEhBX,EAAiB0B,cAAcF,EAAKG,MAAMC,KACxC,SAACC,GACKJ,EAAKd,WAGTc,EAAKT,QAAUa,EACfJ,EAAKK,eAAe3B,KAEtB,SAAA4B,GACMN,EAAKd,WAGTc,EAAKV,OAASgB,EACdN,EAAKK,eAAe3B,yCAKfqB,GAAwC,IAAAQ,EAAAzB,KAA5B0B,EAA4BC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,QACxC3B,KAAKI,UAAW,EAEhBX,EAAiBqC,WAAWb,EAAKG,KAAMM,GAAUL,KAC/C,SAACC,GACKG,EAAKrB,WAGTqB,EAAKhB,QAAUa,EACfG,EAAKF,eAAe3B,KAEtB,SAAA4B,GACMC,EAAKrB,WAGTqB,EAAKjB,OAASgB,EACdC,EAAKF,eAAe3B,sCAMxBI,KAAKI,UAAW,EAEZJ,KAAKO,cAAgBb,GAASM,KAAKO,cAAgBX,IACrDI,KAAKM,SACLN,KAAKuB,eAAe3B,IAGtBI,KAAKM,4CAIL,OAAON,KAAKO,0CAIZ,OAAOP,KAAKQ,sCAIZ,OAAOR,KAAKS,gBAhHSnB,EAAWyC,WAAXF,GAZvB,QACA,QACA,OACA,YACA,UACA,cAOIhC,EACGH,MAAQA,EADXG,EAEGF,QAAUA,EAFbE,EAGGD,KAAOA,EAiHhBoC,EAAOC,QAAUpC","file":"140.js"}